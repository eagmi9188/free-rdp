
name: Free-RDP-Windows

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Enable RDP & Set Password
        shell: powershell
        run: |
          echo "â–ª ä¿®æ”¹æ³¨å†Œè¡¨ä»¥å¼€å¯ RDP"
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name 'fDenyTSConnections' -Value 0

          echo "â–ª å¼€æ”¾ RDP é˜²ç«å¢™"
          Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

          echo "â–ª è®¾ç½®å¯†ç ï¼ˆé»˜è®¤ï¼š123456Aa!ï¼‰"
          $password = ConvertTo-SecureString "123456Aa!" -AsPlainText -Force
          Set-LocalUser -Name "runneradmin" -Password $password

      - name: Show RDP Connection Info
        shell: powershell
        run: |
          echo "===================================="
          echo "        ğŸš€ FREE WINDOWS RDP          "
          echo "===================================="
          echo "IP Address:"
          (Get-NetIPAddress -AddressFamily IPv4).IPAddress
          echo ""
          echo "Username: runneradmin"
          echo "Password: 123456Aa!"
          echo "Valid for: 6 hours"
          echo "===================================="

      - name: Keep VM Alive for 6 Hours
        shell: powershell
        run: |
          Start-Sleep -Seconds 21600
